"use strict";(self.webpackChunkdocsite=self.webpackChunkdocsite||[]).push([[8301],{3722:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>d,contentTitle:()=>s,default:()=>p,frontMatter:()=>t,metadata:()=>c,toc:()=>a});var r=n(4848),l=n(8453);const t={},s="Developing ob-operator",c={id:"developer/development",title:"Developing ob-operator",description:"environment-setup",source:"@site/docs/developer/development.md",sourceDirName:"developer",slug:"/developer/development",permalink:"/ob-operator/docs/developer/development",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/ob-operator/tree/master/docsite/docs/developer/development.md",tags:[],version:"current",frontMatter:{},sidebar:"developerSidebar",previous:{title:"Develop ob-operator locally",permalink:"/ob-operator/docs/developer/develop-locally"}},d={},a=[{value:"environment-setup",id:"environment-setup",level:2},{value:"build ob-operator",id:"build-ob-operator",level:2},{value:"deploy",id:"deploy",level:2},{value:"check logs",id:"check-logs",level:2}];function i(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.h1,{id:"developing-ob-operator",children:"Developing ob-operator"}),"\n",(0,r.jsx)(o.h2,{id:"environment-setup",children:"environment-setup"}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsxs)(o.li,{children:["\n",(0,r.jsxs)(o.p,{children:["go\nob-operator requires ",(0,r.jsx)(o.a,{href:"https://go.dev/doc/install",children:"go 1.20 or above"})," to build, you can refer to the official document to setup go environment."]}),"\n"]}),"\n",(0,r.jsxs)(o.li,{children:["\n",(0,r.jsxs)(o.p,{children:["make\nob-operator uses ",(0,r.jsx)(o.a,{href:"https://www.gnu.org/software/make/",children:"make"})," for a variety of build and test actions, it's need to be installed before you go."]}),"\n"]}),"\n",(0,r.jsxs)(o.li,{children:["\n",(0,r.jsxs)(o.p,{children:["kubebuilder\nob-operator uses kubebuilder as operator framework, before you dive into the code, it's highly recommended to read ",(0,r.jsx)(o.a,{href:"https://book.kubebuilder.io",children:"kubebuilder books"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(o.h2,{id:"build-ob-operator",children:"build ob-operator"}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsx)(o.li,{children:"build docker image\nuse the following command to build docker image"}),"\n"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"make docker-build\n"})}),"\n",(0,r.jsxs)(o.ol,{start:"2",children:["\n",(0,r.jsx)(o.li,{children:"push docker image to repository\nuse the following command to push docker image"}),"\n"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"make docker-push\n"})}),"\n",(0,r.jsx)(o.h2,{id:"deploy",children:"deploy"}),"\n",(0,r.jsxs)(o.ol,{children:["\n",(0,r.jsx)(o.li,{children:"install crd to K8s cluster\nuse the following command to generate crd and install to K8s cluster"}),"\n"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"make install\n"})}),"\n",(0,r.jsx)(o.p,{children:"if you wish to save the crd as yaml format config file, you can run the following command"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"make export-crd\n"})}),"\n",(0,r.jsx)(o.p,{children:"the generated file will be placed under deploy directory and named crd.yaml"}),"\n",(0,r.jsxs)(o.ol,{start:"2",children:["\n",(0,r.jsx)(o.li,{children:"deploy controller-manager to K8s cluster\nuse the following command to generate controller-manager config and deploy to K8s cluster"}),"\n"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"make deploy\n"})}),"\n",(0,r.jsx)(o.p,{children:"if you wish to save the controller-manager deployment config as yaml format config file, you can run the following command"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"make export-operator\n"})}),"\n",(0,r.jsx)(o.p,{children:"the generated file will be placed under deploy directory and named operator.yaml"}),"\n",(0,r.jsx)(o.p,{children:"After the above steps, CRDs and controller-manager are deployed to K8s cluster, to check the deployments are successful, you can check with the following command"}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"# check crds\nkubectl get crds\n\n# check controller-manager\nkubectl get pods -n oceanbase-system\n"})}),"\n",(0,r.jsxs)(o.p,{children:["you will get something like the following\n",(0,r.jsx)(o.img,{alt:"crd",src:n(8242).A+"",title:"crd",width:"998",height:"364"}),"\n",(0,r.jsx)(o.img,{alt:"controller-manager",src:n(9849).A+"",title:"controller-manager",width:"1192",height:"142"})]}),"\n",(0,r.jsx)(o.h2,{id:"check-logs",children:"check logs"}),"\n",(0,r.jsx)(o.p,{children:"After deploying the crds and controller-manager, ob-operator will handle OceanBase related objects lifecycle management, you may test your own business by create a cr and make some modifications, ob-operator will handle the certain event. To test everything works properly, you can use the following command to check log message."}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{children:"kubectl logs oceanbase-controller-manager-xxx -c manager -n oceanbase-system\n"})}),"\n",(0,r.jsxs)(o.p,{children:[(0,r.jsx)(o.code,{children:"oceanbase-controller-manager-xxx"})," should be replaced by the real pod name"]})]})}function p(e={}){const{wrapper:o}={...(0,l.R)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},9849:(e,o,n)=>{n.d(o,{A:()=>r});const r=n.p+"assets/images/controller-manager-0de1798bbe1b3efaf7c3b5220833c22a.jpg"},8242:(e,o,n)=>{n.d(o,{A:()=>r});const r=n.p+"assets/images/crd-47aa9fece0a41acba60daa1a0270758a.jpg"},8453:(e,o,n)=>{n.d(o,{R:()=>s,x:()=>c});var r=n(6540);const l={},t=r.createContext(l);function s(e){const o=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function c(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),r.createElement(t.Provider,{value:o},e.children)}}}]);