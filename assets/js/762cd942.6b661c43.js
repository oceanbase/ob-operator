"use strict";(self.webpackChunkdocsite=self.webpackChunkdocsite||[]).push([[1030],{2775:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var a=n(4848),o=n(8453);const r={sidebar_position:5},s="Physical standby tenant",i={id:"manual/ob-operator-user-guide/high-availability/standby-tenant-of-ob-operator",title:"Physical standby tenant",description:"Physical standby tenant is available in ob-operator 2.1.0 and later versions.",source:"@site/docs/manual/500.ob-operator-user-guide/300.high-availability/600.standby-tenant-of-ob-operator.md",sourceDirName:"manual/500.ob-operator-user-guide/300.high-availability",slug:"/manual/ob-operator-user-guide/high-availability/standby-tenant-of-ob-operator",permalink:"/ob-operator/docs/manual/ob-operator-user-guide/high-availability/standby-tenant-of-ob-operator",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/ob-operator/tree/master/docsite/docs/manual/500.ob-operator-user-guide/300.high-availability/600.standby-tenant-of-ob-operator.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"manualSidebar",previous:{title:"Restore data from a backup",permalink:"/ob-operator/docs/manual/ob-operator-user-guide/high-availability/data-recovery-of-ob-operator"},next:{title:"Appendix",permalink:"/ob-operator/docs/category/appendix"}},c={},d=[{value:"Modify the configuration file",id:"modify-the-configuration-file",level:2},{value:"Combined use of parameters",id:"combined-use-of-parameters",level:2},{value:"Tenant upgrade and switchover",id:"tenant-upgrade-and-switchover",level:2}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"physical-standby-tenant",children:"Physical standby tenant"}),"\n",(0,a.jsx)(t.admonition,{type:"tip",children:(0,a.jsx)(t.p,{children:"Physical standby tenant is available in ob-operator 2.1.0 and later versions."})}),"\n",(0,a.jsx)(t.p,{children:"This topic describes the physical standby tenant feature. This feature is available in OceanBase Database V4.x and provides your key applications with important capabilities such as high availability, data protection, and disaster recovery. It requires OBTenant and OBTenantOperation resources. You can use OBTenant resources to define tenants and OBTenantOperation resources to define tenant O&M operations. You can create a physical standby tenant from backup data or by creating an empty tenant. The physical standby tenant feature is closely related to the data restore feature."}),"\n",(0,a.jsx)(t.h2,{id:"modify-the-configuration-file",children:"Modify the configuration file"}),"\n",(0,a.jsxs)(t.p,{children:["Parameters of a physical standby tenant are also contained in the OBTenant resource. For more information, see ",(0,a.jsx)(t.a,{href:"/ob-operator/docs/manual/ob-operator-user-guide/high-availability/data-recovery-of-ob-operator",children:"Restore data from a backup"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:"tenant_standby.yaml",children:'apiVersion: oceanbase.oceanbase.com/v1alpha1  \nkind: OBTenant  \nmetadata:  \n  name: t1s\n  # namespace: oceanbase\nspec:\n  obcluster: obcluster\n  tenantName: t1s\n  unitNum: 1\n  tenantRole: STANDBY\n  source:\n    restore:\n      bakDataSource:\n        # type: "NFS"\n        # path: "t1/dataBackup"\n        type: "OSS"\n        path: "oss://bucket/backup?host=oss-cn-hangzhou.aliyuncs.com"\n        ossAccessSecret: "oss-access"\n      archiveSource:\n        # type: "NFS"\n        # path: "t1/logArchive"\n        type: "OSS"\n        path: "oss://bucket/archive?host=oss-cn-hangzhou.aliyuncs.com"\n        ossAccessSecret: "oss-access"\n      until:\n        unlimited: true\n      replayLogUntil:\n        unlimited: true\n    tenant: t1\n  fields: values\n'})}),"\n",(0,a.jsx)(t.p,{children:"The parameters are described as follows:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["tenantRole: the role of the tenant. If you want to use the tenant as a standby tenant, set this parameter to ",(0,a.jsx)(t.code,{children:"STANDBY"}),". The default value is ",(0,a.jsx)(t.code,{children:"PRIMARY"}),"."]}),"\n",(0,a.jsxs)(t.li,{children:["source: the source of tenant data.","\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"restore: the source of the backup data for restore."}),"\n",(0,a.jsx)(t.li,{children:"tenant: the name of the primary tenant whose data will be synchronized to the created tenant."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"combined-use-of-parameters",children:"Combined use of parameters"}),"\n",(0,a.jsxs)(t.p,{children:["In the ",(0,a.jsx)(t.code,{children:"spec.source"})," section of the configuration file of the OBTenant resource, the ",(0,a.jsx)(t.code,{children:"restore"})," parameter specifies the information of the data restore source and the ",(0,a.jsx)(t.code,{children:"tenant"})," parameter specifies the name of the primary tenant. The behavior of ob-operator varies based on the configuration of the two parameters."]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["If you specify both the ",(0,a.jsx)(t.code,{children:"restore"})," and ",(0,a.jsx)(t.code,{children:"tenant"})," parameters, ob-operator restores the standby tenant based on the configuration of the ",(0,a.jsx)(t.code,{children:"restore"})," parameter, sets the log restore source of the standby tenant to the primary tenant, and replay the logs based on the values of the ",(0,a.jsx)(t.code,{children:"until"})," and ",(0,a.jsx)(t.code,{children:"replayLogUntil"})," parameters."]}),"\n",(0,a.jsxs)(t.li,{children:["If you specify only the ",(0,a.jsx)(t.code,{children:"restore"})," parameter, ob-operator restores the tenant based on the configuration of the ",(0,a.jsx)(t.code,{children:"restore"})," parameter, and sets the tenant role as specified by the ",(0,a.jsx)(t.code,{children:"tenantRole"})," parameter."]}),"\n",(0,a.jsxs)(t.li,{children:["If you specify only the ",(0,a.jsx)(t.code,{children:"tenant"})," parameter, ob-operator checks the existence of the specified tenant and the integrity of the log streams. If the check is passed, ob-operator creates an empty standby tenant and synchronizes the data from the specified primary tenant to the standby tenant."]}),"\n",(0,a.jsxs)(t.li,{children:["If you specify neither the ",(0,a.jsx)(t.code,{children:"restore"})," nor ",(0,a.jsx)(t.code,{children:"tenant"})," parameter, the configuration file cannot be verified and cannot be applied to the cluster."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"tenant-upgrade-and-switchover",children:"Tenant upgrade and switchover"}),"\n",(0,a.jsxs)(t.p,{children:["For more information, see ",(0,a.jsx)(t.a,{href:"/ob-operator/docs/manual/ob-operator-user-guide/tenant-management-of-ob-operator/tenant-operation",children:"Perform tenant O&M operations"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>i});var a=n(6540);const o={},r=a.createContext(o);function s(e){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),a.createElement(r.Provider,{value:t},e.children)}}}]);