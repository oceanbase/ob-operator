# Build the manager binary
FROM golang:1.22 as builder

ARG GOPROXY=https://goproxy.io,direct
ARG GOSUMDB=sum.golang.org

WORKDIR /workspace
# copy everything
COPY . .
RUN make cli-dep-install cli-build

# start build docker image
FROM openanolis/anolisos:8.8
WORKDIR /
COPY --from=builder /workspace/bin/obocli .
RUN yum update -y && yum clean all
RUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

ENTRYPOINT ["/obocli"]